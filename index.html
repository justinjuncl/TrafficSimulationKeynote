<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Traffic Simulation</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="전찬호">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/main.css">
		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/default.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<div id="trafficContainer"></div>

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<h1>교통 시뮬레이션</h1>
					<h3>
						<a href="http://hakim.se">전찬호</a> 와 <a href="http://twitter.com/hakimel">정현엽</a>
					</h3>
					<h4>2014년 7월 22일</h4>
				</section>

				<section data-state="motive">
					<strong><h2>동기</h2></strong>
					<div class="shadow" style="margin-left: -100px; ">
						<h3>대전 천변고속화도로 BRT 공사에 정체… 환불요구 빗발</h3>
						<h4>병목현상 빚어지지만…우회안내 미흡 등 '불만 속출'</h4>
						<p><small>대전천변도시고속화도로가 상습정체를 빚으면서 이용자들의 불만이 높다.

유료도로지만 종종 발생하는 사고 탓에 일반도로와 사정이 별반 다르지 않고, BRT 공사에 따른 병목현상이 빚어지지만 우회 안내 등이 미흡해 이용자들의 요금 환불 시비가 잇따르고 있다.

20일 천변도시고속화도로 이용자들에 따르면 지난해 12월부터 내년 6월까지 진행되는 대전~오송간 BRT 공사 탓에 상습 교통체증이 발생하고 있다.

이 도로는 왕복 6차로지만 공사가 진행되면서 왕복 2차로를 차단, 출·퇴근시 병목현상에 따른 극심한 차량정체가 빚어지고 있다.

서구 만년동이나 월평동, 대덕구 오정동 인근에서 신탄진이나 청주 방향으로 출·퇴근하는 이용자들은 꼼짝없이 도로에 갇혀 지각하는 일이 비일비재하다.

더욱이 이 도로는 800원의 이용료를 내는 유료도로지만 요금소를 통과한 이후 차량정체를 파악할 수 있어 이용자들의 불만은 극에 달하고 있다.

이용자 A씨는 “유성구 원촌교사거리 인근은 평소에도 정체가 자주 발생하는 곳이지만 BRT 공사 탓에 2개 차로를 막아 차량정체는 물론 병목현상에 따른 교통사고도 빈번해 특단의 대책이 필요한 것 같다”고 목소리를 높였다.

천변도시고속화도로는 도시 교통난 해소를 명목으로 2004년 갑천변 한밭대교~원촌교~대덕대교(5㎞) 구간에 걸쳐 외자 유치 민간투자사업으로 개통됐다.

30년 뒤 시에 기부하는 조건이며 (주)대전천변고속화도로가 운영을 맡고 있다. 개통 당시에는 통행차량이 예상 수치에 크게 못 미치면서 수년간 시의 재정지원이 수백억원에 달하는 등 혈세 낭비 논란을 빚기도 했다.

적자 보전을 위해 2012년에는 500원이던 통행료를 800원으로 인상한 뒤 최근에는 이익으로 돌아섰다는 얘기도 나돌고 있다. 이용자들은 운영사인 (주)천변도시고속화도로에 대해서도 불만도 쏟아내고 있다.

요금소 진입 이전에 차량정체 상황이나, 사고 상황 등에 대한 사전 안내를 통해 이용자들이 우회를 결정할 수 있도록 홍보해야 하지만 무대응으로 일관한다는 것이다. 유료도로임에도 일반도로와 사정이 비슷해 통행료 환불시비가 종종 발생하는 상황이다.

직장인 B씨는 “(주)천변도시고속화도로가 수익 창출에만 급급해 이용자들을 우롱하고 있지만 이를 관리, 감독하는 대전시 무엇을 하고 있느냐”며 “이용자들이 불편을 겪지 않도록 시의 적극적인 대책 마련과 철저한 지도, 감독이 필요하다”고 말했다.

시 관계자는 “일부 차로 통행제한으로 교통이 혼잡해 진출입로 주변에 우회 안내 표지판이나 현수막, 도로전광판(ITS) 등에 홍보하고 있다”며 “갑천도로(문예지하차도) 진입 전에도 표지판 추가 설치 등을 통해 이용자들의 불편을 최소화하겠다”고 말했다.</small></p>
					</div>
					<div class="shadow" style="margin-top:-500px;margin-left:-400px;">
						<h3>6월 마지막주, 나들이 차량 몰리며 고속도로 정체 시작</h3>
						<p><small>6월 마지막 주 휴일인 29일 나들이 차량이 몰리면서 주요 고속도로에서 지·정체 현상이 빚어지고 있다.

한국도로공사는 이날 오후 3시 현재 고속도로를 통해 수도권을 빠져나간 차량은 18만여대, 들어온 차량은 17만여대로 집계됐다고 밝혔다.

경부고속도로 서울방향 안성나들목~안성분기점 4.52㎞ 구간, 양재나들목~서초나들목 2.53㎞ 구간 등에서 정체 현상을 받고 있다.

경부고속도로 부산방향 경부선입구(한남)~잠원나들목 1㎞ 구간, 잠원나들목~반포나들목 0.89㎞ 구간, 반포나들목~서초나들목 1.91㎞ 구간 등에서 차량이 제 속도를 못 내고 있다.

서해안고속도로 서울방향 당진나들목~송악나들목 8.33㎞ 구간, 송악나들목~행담도휴게소 2.96㎞ 구간, 행담도휴게소~서평택나들목 10.05㎞ 구간, 일직분기점~금천나들목 3.51㎞ 구간 등에서도 차량이 거북이 운행을 하고 있다.

영동고속도로 인천방향 진부나들목~속사나들목 7.26㎞ 구간, 여주나들목~여주분기점 5.82㎞ 구간, 여주분기점~여주휴게소 3.82㎞ 구간 등에서 답답한 차량 흐름을 보이고 있다.

한국도로공사 관계자는 "오늘 하루 고속도로를 통해 33만여대가 빠져나가고 37만여대가 들어올 것으로 보인다"며 "아직 휴가철이 시작되지 않아 평소 주말·휴일 비슷한 흐름을 보이고 있다"고 설명했다.

한국도로공사는 이날 오후 4~5시께 정체가 절정을 이뤘다가 오후 11시께 해소될 것으로 내다봤다.</small></p>
					</div>
				</section>

				<section data-state="model">
					<h2>모델</h2>
					<ul>
						<li>장소</li>
						<li>차</li>
						<li>사이클</li>
					</ul>
					<p style="margin-top: 100px;"><a href="#/5/1"><small>시뮬레이션에 영향을 주는 요소들</small></a></p>
				</section>

				<section data-background="#4d7e65">

					<section data-state="zoomOut">
						<h2>장소</h2>
						<ul>
							<li>생성기</li>
							<li>소멸기</li>
							<li>교차로</li>
							<li>도로</li>
						</ul>
					</section>

					<section data-state="zoomGenerator">
						<h3>생성기</h3>
					</section>

					<section data-state="zoomDestroyer">
						<h3>소멸기</h3>
					</section>

					<section data-state="zoomJunction">
						<h3>교차로</h3>
					</section>

					<section data-state="zoomRoadVertical">
						<h3>도로</h3>
					</section>

				</section>

				<section data-background="#4D567E">

					<section data-state="zoomOut">
						<h2>사이클</h2>
						<ul>
							<li>차선 변경 결정</li>
							<li>차선 변경 실행</li>
							<li>속도 변경</li>
							<li>위치 변경</li>
						</ul>
					</section>

					<section data-state="zoomRoadHorizontal">

						<h3>차선 변경 결정</h3>
						<ul>
							<li><p>더 빨리 가고 싶어서 하는 경우
								<ul>
									<li class="fragment">안전 거리</li>
									<li class="fragment">앞차의 속도</li>
									<li class="fragment">트럭의 유무</li>
								</ul>
							</p></li>

							<li><p>좌회전 등을 하기 위해 필연적으로 변경해야 하는 경우
								<ul>
									<li class="fragment">도로 끝까지의 거리</li>
									<li class="fragment">해야하는 차선 변경 횟수</li>
								</ul>
							</p></li>
						</ul>

					</section>

					<section>
						<h3>차선 안전성 판단</h3>
						<pre><code>
isSafeLaneDecision: function ( i ) {

  if ( this.lane + i < 0 || this.lane + i >= this.location.laneCount ) {

    return false;

  }

  if ( this.location.vehicleAtLocation( this.lane + i, this.localY ) ) {

    return false;

  }

  var vehicleSideBehind = this.location.vehicleBehindLocation( this.lane + i, this.localY );

  if ( !vehicleSideBehind ) {

    return true;

  }

  var s = vehicleSideBehind.speed;

  if ( this.speed === 0 ) return true;

  if ( s > 3 * this.speed ) {

    return false;

  }

  if ( this.gammaSide( i ) <= this.safetyDistance * 0.5 ) {

    return false;

  }

  return true;

}
						</code></pre>
					</section>

					<section>
						<h3>차선 변경 실행</h3>
					</section>

					<section>
						<h3>속도 변경</h3>
						<ul>
							<li class="fragment">안전 거리</li>
							<li class="fragment">앞차의 속도</li>
							<li class="fragment">제한 속도</li>
							<li class="fragment">옆 차의 깜빡이</li>
						</ul>
					</section>

					<section data-state="zoomDestroyer">
						<h3>위치 변경</h3>
					</section>

					<section>
						<h3>위치 변경</h3>
						<pre><code>
updateLocation: function ( deltaTime ) {

  switch ( this.location.type ) {

    case "Road":

      var newLocalY = this.localY + this.speedY * deltaTime;
      var diff = newLocalY + this.length - this.location.length;

      if ( diff < 0 ) {

        this.localY = newLocalY;

      } else {

        this.location.vehiclesCount--;
        this.setLocation( this.locationTo, this.lane, diff );

      }

      break;

    default:

      break;

  }

}
						</code></pre>
					</section>

				</section>

				<section data-state="zoomOut">

					<section>
						<h2 class="fragment fade-out">시험</h2>
					</section>

					<section>
						<h3>시뮬레이션에 영향을 주는 요소들</h3>
						<ul class="el" style="margin-top: 50px;">
							<li>운전자 특성
								<ul style="margin-top: 10px;">
									<li>대략적인 차선 변경 소요 시간</li>
									<li>차선 변경을 하려고 버티는 정도</li>
									<li>최소 차간 거리</li>
									<li class="fragment highlight-blue">제한 속도 지키려는 정도</li>
									<li class="fragment highlight-blue">안전 거리 유지하려는 정도</li>
									<li>차선 변경을 하려는 경향</li>
									<li class="fragment highlight-blue">트럭에 대해 느끼는 부담감</li>
									<li>차선 변경시 기다리는 정도</li>
									<li>차선 변경시 기다리는 시간의 하한선</li>
									<li>차선 변경시 기다리는 시간의 상한선</li>
									<li class="fragment highlight-blue">운전자의 시야</li>
									<li>최대 회전 각도</li>
								</ul>
							</li>
							<li style="margin-top: 50px;">도로 특성
								<ul style="margin-top: 10px;">
									<li>최대 가속도</li>
									<li>제동의 한계</li>
									<li>초기 가속도</li>
									<li class="fragment highlight-blue">제한 속도</li>
									<li>초기 속도</li>
									<li class="fragment highlight-blue">트럭의 비율</li>
									<li>도로의 차선 변경을 못하게 할 초반 길이</li>
									<li>도로 길이</li>
								</ul>
							</li>
						</ul>
						<p style="margin-top: 100px;"><small><a href="#/2">모델</a></small></p>
					</section>

				</section>

				<section data-state="zoomOut">
					<h2>이 모델에서 볼 수 있는 현상</h2>
					<ul>
						<li class="fragment">차가 차선변경을 하려고 버티느라 뒤의 차들이 정체되는 것</li>
						<li class="fragment">차가 모였다가 흩어졌다가를 반복하는 것</li>
						<li class="fragment">처음 차가 생성될시에 앞차가 속도가 크지 않아 앞이 정체되는 것</li>
					</ul>
				</section>

				<section>
					<h2>보강하고 싶은 점</h2>
					<ul>
						<li class="fragment">교차로</li>
						<li class="fragment">곡선 도로</li>
					</ul>
				</section>

				<section>
					<h2>오픈 소스</h2>
					<h3>github.com/justinjuncl/TrafficSimulation</h3>
				</section>

				<!-- END -->

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script src="js/TrafficSimulation.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({

				width: 1440,
				height: 900,
				controls: false,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

			var traffic, canvas,
				generator1, generator2, generator3,
				junction1, junction2, junction3;

			function init() {

				traffic = new Traffic({
					width: 1440,
					height: 900,
					fastForward: 3
				});

				generator1 = traffic.generator({
					x: 100,
					y: 100,
					generationRate: 1.5
				});

				generator2 = traffic.generator({
					x: 1340,
					y: 0
				});

				generator3 = traffic.generator({
					x: 1440,
					y: 100
				});

				junction1 = traffic.junction({
					x: 100,
					y: 740
				});

				junction2 = traffic.junction({
					x: 1340,
					y: 740
				});

				junction3 = traffic.junction({
					x: 1340,
					y: 100
				});

				traffic.link(
					generator1,
					junction1
				);

				traffic.link(
					junction1,
					junction2
				);

				traffic.link(
					junction2,
					junction3
				);

				traffic.link(
					junction3,
					generator1
				);

				traffic.road({
					from: junction3,
					to: generator2
				});

				traffic.road({
					from: junction3,
					to: generator3
				});

			}

			var truckContainer = null;

			var origin = new Vector2( -50, 790 );
			var point = origin;
			var vStop;

			Reveal.configure({
				keyboard: {
					81: function () { traffic.start(); },
					87: function () { traffic.pause(); },
					69: function () { traffic.resetSimulation(); canvas.renderBlocks(); canvas.renderVehicles(); },
					82: function () {
						vStop = traffic.vehicle({
							location: junction1.inComing[2],
							lane: 2,
							localY: 350,
							isStationary: true
						});
					},
					84: function () {

						vStop.removeLocation();
						vStop.removeVehicle();

					},
					88: function () {

						traffic.vehicles.forEach( function (element, index, array) { element.junctionDecision = 1; } );

					}
				}
			});

			var hasStarted = false;

			Reveal.addEventListener( 'model', function () {

				if ( !hasStarted ) {

					init();
					hasStarted = true;
					traffic.start();

					truckContainer = document.getElementById( "truckContainer" );

					render();

				}

			}, false);

			Reveal.addEventListener( 'zoomJunction', function () {

				point = offset(-200, 2310);
				canvas.scale = 4;
				render();

			}, false);

			Reveal.addEventListener( 'zoomGenerator', function () {

				point = offset(-200, 300);
				canvas.scale = 4;
				render();

			}, false);

			Reveal.addEventListener( 'zoomDestroyer', function () {

				point = offset(-4400, 300);
				canvas.scale = 4;
				render();

			}, false);

			Reveal.addEventListener( 'zoomRoadVertical', function () {

				point = offset(-200, 1000);
				canvas.scale = 4;
				render();

			}, false);

			Reveal.addEventListener( 'zoomOut', function () {

				point = origin;
				canvas.scale = 1;
				render();

			}, false);

			Reveal.addEventListener( 'zoomRoadHorizontal', function () {

				point = offset(-1000, 300);
				canvas.scale = 4;
				render();

			}, false);

			function offset (x, y) {

				return new Vector2(origin.x + x, origin.y + y);
			}

			function render () {

				canvas.contextBlocks.setTransform(canvas.scale, 0, 0, -canvas.scale, point.x, point.y);
				canvas.contextVehicles.setTransform(canvas.scale, 0, 0, -canvas.scale, point.x, point.y);

				canvas.renderBlocks();
				canvas.renderVehicles();

			}

		</script>

	</body>
</html>
